var w=Object.defineProperty;var b=(c,t,i)=>t in c?w(c,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[t]=i;var a=(c,t,i)=>b(c,typeof t!="symbol"?t+"":t,i);import{v as g,r as y,b as D,K as P,m as C,c as p,d as l,F as S,n as T,i as m,e as Y,j as z}from"./vendor-D10xMT_S.js";import{a0 as M,I as X,e as _,P as k,v as R,a6 as I,ai as W,K as F,Q as U,Y as E,V as j,s as f,h as H,M as v,p as L}from"./threejs-R2oN4ICD.js";import{_ as A,e as O}from"../lib/index-BiiMp2pO.js";class B{constructor(t){this.ctx=t.ctx,this.pos=t.pos,this.col=t.col,this.row=t.row,this.colors=t.colors,this.triangleWidth=t.triangleWidth,this.triangleHeight=t.triangleHeight,this.alpha=this.tAlpha=1,this.isLeft=this.pos%2,this.color=this.colors[Math.floor(Math.random()*this.colors.length)],this.rgb=this.hexToRgb(this.color),this.selectedForTrail=!1,this.opened=!1,this.opening=!1,this.closing=!1,this.tX1=this.isLeft?(this.col+1)*this.triangleWidth:this.col*this.triangleWidth,this.tX2=this.isLeft?this.col*this.triangleWidth:(this.col+1)*this.triangleWidth,this.tX3=this.isLeft?(this.col+1)*this.triangleWidth:this.col*this.triangleWidth,this.tY1=.5*this.row*this.triangleHeight,this.tY2=.5*(this.row+1)*this.triangleHeight,this.tY3=.5*(this.row+2)*this.triangleHeight,this.x1=this.tX1,this.x2=this.tX1,this.x3=this.tX1,this.y1=this.tY1,this.y2=this.tY1,this.y3=this.tY1}draw(){this.ctx.fillStyle="rgba("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+","+this.alpha+")",this.ctx.beginPath(),this.ctx.moveTo(this.x1,this.y1),this.ctx.lineTo(this.x2,this.y2),this.ctx.lineTo(this.x3,this.y3),this.ctx.closePath(),this.ctx.fill()}open(t,i,s,e){(!this.opened||!this.opening)&&(this.tweenClose&&this.tweenClose.kill(),this.opening=!0,this.direction=t||"top",this.delay=e||0,this.tAlpha=s,this.tSpeed=i||1.5,this.direction==="side"?(this.x1=this.x2=this.x3=this.tX1,this.y1=this.tY1,this.y2=this.tY2,this.y3=this.tY3):this.direction==="top"?(this.x1=(this.tX2+this.tX3)/2,this.x2=this.tX2,this.x3=this.tX3,this.y1=(this.tY2+this.tY3)/2,this.y2=this.tY2,this.y3=this.tY3):this.direction==="bottom"&&(this.x1=this.tX1,this.x2=this.tX2,this.x3=(this.tX1+this.tX2)/2,this.y1=this.tY1,this.y2=this.tY2,this.y3=(this.tY1+this.tY2)/2),this.tweenOpen=g.to(this,{x1:this.tX1,x2:this.tX2,x3:this.tX3,y1:this.tY1,y2:this.tY2,y3:this.tY3,alpha:this.tAlpha,duration:this.tSpeed,ease:g.easeInOut,delay:this.delay,onComplete:()=>this.openComplete(),onCompleteParams:[this]}))}close(t,i,s){this.direction=t||"top",this.delay=s||1,this.tSpeed=i||.8,this.opened=!1,this.closing=!0;let e,r,n,h,o,d;this.direction==="side"?(e=r=n=this.tX1,h=this.tY1,o=this.tY2,d=this.tY3):this.direction==="top"?(e=(this.tX2+this.tX3)/2,r=this.tX2,n=this.tX3,h=(this.tY2+this.tY3)/2,o=this.tY2,d=this.tY3):this.direction==="bottom"&&(e=this.tX1,r=this.tX2,n=(this.tX1+this.tX2)/2,h=this.tY1,o=this.tY2,d=(this.tY1+this.tY2)/2),this.tweenClose&&this.tweenClose.kill(),this.tweenClose=g.to(this,{x1:e,x2:r,x3:n,y1:h,y2:o,y3:d,alpha:0,duration:this.tSpeed,ease:g.easeInOut,delay:this.delay,onComplete:()=>this.closeComplete(),onCompleteParams:[this]})}openComplete(){this.opened=!0,this.opening=!1,this.closing=!1}closeComplete(){this.opened=!1,this.opening=!1,this.closing=!1}hexToRgb(t){let i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}}class V{constructor(){a(this,"mouseX",0);a(this,"mouseY",0);a(this,"mouseOldX",0);a(this,"mouseOldY",0);a(this,"triangleWidth",21);a(this,"triangleHeight",27);a(this,"speedTriangleAppear",.1);a(this,"speedTriangleDisappear",.1);a(this,"speedTriangleOpen",1);a(this,"triangleMaxLength",18);a(this,"triangleIntervalCreation",100);a(this,"delayBeforeDisappear",2);a(this,"cols",0);a(this,"rows",0);a(this,"triangles",[]);a(this,"randomAlpha",!0);a(this,"neighbours",["side","top","bottom"]);a(this,"colors",["#eb9000","#f6b400","#440510","#8a0a08","#05391e","#004b25","#0c1a36","#01235d","#0b3f7a","#0561a6","#007ecb","#32b2fa","#54cefc","#91dffa"]);a(this,"interval",null);this.initCanvas(),this.start()}initCanvas(){this.parent=document.getElementById("preview"),this.canvas=document.getElementById("canvas"),this.width=this.canvas.width=this.parent.scrollWidth,this.height=this.canvas.height=this.parent.scrollHeight,this.ctx=this.canvas.getContext("2d"),this.initParams(),g.ticker.add(()=>this.draw()),this.resize()}initParams(){this.cols=Math.floor(this.width/this.triangleWidth),this.cols=this.cols%2?this.cols:this.cols-1,this.rows=Math.floor(this.height/this.triangleHeight)*2,this.triangles=[]}initGrid(){for(let t=0;t<this.rows;t++)for(let i=0;i<this.cols;i++){let s=i+t*this.cols,e=new B({pos:s,col:i,row:t,triangleWidth:this.triangleWidth,triangleHeight:this.triangleHeight,colors:this.colors,ctx:this.ctx});this.triangles.push(e),e.draw()}}start(){this.interval&&clearInterval(this.interval),this.initParams(),this.initGrid(),this.createTriangle(),this.interval=setInterval(()=>{this.createTriangle()},this.triangleIntervalCreation)}shuffleArray(t){for(let i,s,e=t.length;e;i=Math.floor(Math.random()*e),s=t[--e],t[e]=t[i],t[i]=s);return t}getNeighbour(t){this.shuffleArray(this.neighbours);for(let i=0;i<this.neighbours.length;i++)if(this.neighbours[i]==="top"){if(t.row!==0&&!this.triangles[t.pos-this.cols].selectedForTrail&&!this.triangles[t.pos-this.cols].opened)return{triangle:this.triangles[t.pos-this.cols],openDir:"top",closeDir:"top"}}else if(this.neighbours[i]==="bottom"){if(t.row!==this.rows-1&&!this.triangles[t.pos+this.cols].selectedForTrail&&!this.triangles[t.pos+this.cols].opened)return{triangle:this.triangles[t.pos+this.cols],openDir:"bottom",closeDir:"top"}}else if(this.neighbours[i]==="side"){if(t.isLeft&&t.col!==this.cols-1&&!this.triangles[t.pos+1].selectedForTrail&&!this.triangles[t.pos+1].opened)return{triangle:this.triangles[t.pos+1],openDir:"side",closeDir:"top"};if(!t.isLeft&&t.col!==0&&!this.triangles[t.pos-1].selectedForTrail&&!this.triangles[t.pos-1].opened)return{triangle:this.triangles[t.pos-1],openDir:"side",closeDir:"top"}}return null}createTriangle(){for(let r=0;r<this.triangles.length;r++)this.triangles[r].selectedForTrail=!1;let t=Math.floor(Math.random()*this.triangleMaxLength-2)+2,i=Math.round(Math.random()*this.triangles.length),s=this.triangles[i];if(!s)return;s.selectedForTrail=!0;let e={triangle:s,openDir:"side",closeDir:"side"};for(let r=0;r<t;r++){let n=this.randomAlpha&&Math.random()<.8?Math.random()*.5:1,h=this.getNeighbour(e.triangle);if(h!=null)h.triangle.selectedForTrail=!0,e.triangle.closeDir=h.openDir,e.triangle.open(e.openDir,this.speedTriangleOpen,n,r*this.speedTriangleAppear),e.triangle.close(e.closeDir,1,this.delayBeforeDisappear+r*this.speedTriangleDisappear),e=h;else{e.triangle.open(e.openDir,this.speedTriangleOpen,n,(r+1)*this.speedTriangleAppear),e.triangle.close(e.closeDir,1,this.delayBeforeDisappear+(r+1)*this.speedTriangleDisappear);break}}}initGUI(){this.gui=new M({container:this.parent}),this.gui.domElement.style.position="absolute",this.gui.domElement.style.right="0",this.gui.domElement.style.top="0",this.gui.domElement.style.zIndex="999",this.gui.add(this,"triangleWidth",10,50,1).name("Triangle Width").onFinishChange(()=>this.start()),this.gui.add(this,"triangleHeight",10,50,1).name("Triangle Height").onFinishChange(()=>this.start()),this.gui.add(this,"triangleMaxLength",2,40,1).name("Triangle MaxLength").onFinishChange(()=>this.start()),this.gui.add(this,"triangleIntervalCreation",100,1e3,100).name("Triangle Creation delay").onFinishChange(()=>this.start()),this.gui.add(this,"delayBeforeDisappear",.02,4,.01).name("Disappear delay").onFinishChange(()=>this.start()),this.gui.add(this,"randomAlpha").name("Random Opacity").onFinishChange(()=>this.start()),this.gui.add(this,"pause").name("Pause"),this.gui.add(this,"closeAll").name("closeAll"),this.gui.add(this,"kill").name("Kill"),this.gui.add(this,"start").name("Restart")}draw(){this.ctx.clearRect(0,0,this.width,this.height);for(let t=0;t<this.triangles.length;t++)this.triangles[t].draw()}pause(){this.interval&&clearInterval(this.interval);for(let t=0;t<this.triangles.length;t++)this.triangles[t].tweenClose&&this.triangles[t].tweenClose.kill()}closeAll(){let t=0;this.interval&&clearInterval(this.interval);for(let i=0;i<this.triangles.length;i++)this.triangles[i].tweenOpen&&this.triangles[i].tweenOpen.kill(),(this.triangles[i].opened||this.triangles[i].opening)&&(t++,this.triangles[i].close("top",.8,.2+.0015*t))}kill(){this.interval&&clearInterval(this.interval);for(let t=0;t<this.triangles.length;t++)g.killTweensOf(this.triangles[t]),this.triangles[t].alpha=0}resize(){window.addEventListener("resize",()=>{this.canvas.width=this.parent.offsetWidth,this.canvas.height=this.parent.offsetHeight,this.width=this.canvas.width=this.parent.scrollWidth,this.height=this.canvas.height=this.parent.scrollHeight,this.start()})}}var x=`varying vec2 vUv;
void main() {
    vec3 pos = position;
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos,1.);
}`,N=`uniform float time;
uniform float progress;
uniform float intensity;
uniform float width;
uniform float scaleX;
uniform float scaleY;
uniform float transition;
uniform float radius;
uniform float swipe;
uniform sampler2D texture1;
uniform sampler2D texture2;
uniform sampler2D displacement;
uniform vec4 resolution;
varying vec2 vUv;
mat2 getRotM(float angle) {
    float s = sin(angle);
    float c = cos(angle);
    return mat2(c, -s, s, c);
}
const float PI = 3.1415;
const float angle1 = PI *-0.25;
const float angle2 = PI *0.75;
const float angle = 1.55;

void main()	{
    vec2 newUV = (vUv + vec2(0.0))*resolution.wz + vec2(0.0);
    vec4 disp = texture2D(displacement, vUv);
    vec2 dispVec = vec2(disp.r, disp.g);

    vec2 distortedPosition1 = vUv + getRotM(angle1) * dispVec * 1.40 * progress*-0.3;
    vec4 t1 = texture2D(texture1, distortedPosition1);
    vec2 distortedPosition1g = vUv + getRotM(angle1) * dispVec * 1.40 * progress*0.4;
    vec4 t1g = texture2D(texture1, distortedPosition1g);
    vec2 distortedPosition1r = vUv + getRotM(angle1) * dispVec * 1.40 * progress*1.2;
    vec4 t1r = texture2D(texture1, distortedPosition1r);

    vec2 distortedPosition2 = vUv + getRotM(angle2) * dispVec * 1.40 * (1.0 - progress)*-0.3;
    vec4 t2 = texture2D(texture2, distortedPosition2);
    vec2 distortedPosition2g = vUv + getRotM(angle2) * dispVec * 1.40 * (1.0 - progress)*0.4;
    vec4 t2g = texture2D(texture2, distortedPosition2g);
    vec2 distortedPosition2r = vUv + getRotM(angle2) * dispVec * 1.40 * (1.0 - progress)*1.2;
    vec4 t2r = texture2D(texture2, distortedPosition2r);

    gl_FragColor = mix(vec4(t1r.r,t1g.g,t1.b,t1g.a), vec4(t2r.r,t2g.g,t2.b,t2g.a), progress);
}`,G=`uniform float amount;
uniform sampler2D tDiffuse;
varying vec2 vUv;

float random( vec2 p )
{
    vec2 K1 = vec2(
    23.14069263277926, 
    2.665144142690225 
    );
    return fract( cos( dot(p,K1) ) * 12345.6789 );
}

void main() {

    vec4 color = texture2D( tDiffuse, vUv );
    vec2 uvRandom = vUv;
    uvRandom.y *= random(vec2(uvRandom.y,amount));
    color.rgb += random(uvRandom)*0.15;
    gl_FragColor = vec4( color  );
}`;class K{constructor(){this.target=document.getElementById("time"),this.width=this.target.offsetWidth,this.height=this.target.offsetHeight,this.aspect=this.width/this.height,this.counter=0,this.myEffect={uniforms:{tDiffuse:{value:null},amount:{value:this.counter}},vertexShader:x,fragmentShader:G},this.state={sec:{0:null,1:null},min:{0:null,1:null},hrs:{0:null,1:null}},this.numImages=["https://raw.githubusercontent.com/pizza3/asset/master/numbers/zero.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/one.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/two.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/three.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/four.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/five.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/six.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/seven.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/eight.jpg","https://raw.githubusercontent.com/pizza3/asset/master/numbers/nine.jpg","https://raw.githubusercontent.com/pizza3/asset/master/curt.jpg"],this.material=[],this.plane=[],this.textures=[],this.current=[1,1,1,1,1,1],this.then=0,this.init()}setTextures(t){const i=[];this.numImages.forEach((s,e)=>{let r=new Promise(n=>{this.textures[e]=new X().load(s,n)});i.push(r)}),Promise.all(i).then(()=>{t()})}init(){this.setTextures(()=>{this.createScene(),this.addPlane(2.25,"sec",!0),this.addPlane(3.75,"sec"),this.addPlane(-.75,"min",!0),this.addPlane(.75,"min"),this.addPlane(-3.75,"hrs",!0),this.addPlane(-2.25,"hrs"),this.resize(),this.animation()})}createScene(){this.scene=new _,this.camera=new k(75,this.aspect,.1,1e3),this.camera.position.z=5,this.renderer=new R({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.shadowMap.type=I,this.renderer.outputEncoding=W,this.target.appendChild(this.renderer.domElement),this.renderer.domElement.style.backgroundColor="transparent",this.composer=new F(this.renderer),this.renderScene=new U(this.scene,this.camera),this.composer.addPass(this.renderScene),this.customPass=new E(this.myEffect)}getDigit(t){let i="",s="";if(t==="sec"){let e=new Date().getSeconds();return i=e.toString()[1]!==void 0?e.toString()[1]:e.toString()[0],s=e.toString()[1]!==void 0?e.toString()[0]:0,{0:Number(s),1:Number(i)}}else if(t==="min"){let e=new Date().getMinutes();return i=e.toString()[1]!==void 0?e.toString()[1]:e.toString()[0],s=e.toString()[1]!==void 0?e.toString()[0]:0,{0:Number(s),1:Number(i)}}else{let e=new Date().getHours();return i=e.toString()[1]!==void 0?e.toString()[1]:e.toString()[0],s=e.toString()[1]!==void 0?e.toString()[0]:0,{0:Number(s),1:Number(i)}}}addPlane(t=.2,i="sec",s=!1){let e=this.getDigit(i),r=e[1],n=e[1]+1>9?0:e[1]+1;s?(r=e[0],i==="hrs"?e[0]===2&&e[1]===3?n=0:n=e[0]+1>9?0:e[0]+1:n=e[0]+1>5?0:e[0]+1):i==="hrs"&&e[0]===2&&e[1]===3&&(n=0),this.state[i][1]=e[0],this.state[i][0]=e[1];const h={time:{value:1},progress:{value:0},resolution:{value:new j(400,400)},intensity:{value:1},texture1:{value:this.textures[r]},texture2:{value:this.textures[n]},displacement:{value:this.textures[10]},width:{value:.5,min:0,max:10},scaleX:{value:40,min:.1,max:60},scaleY:{value:40,min:.1,max:60}},o=new f(2,2,10,10);this.material.push(new H({uniforms:h,vertexShader:x,fragmentShader:N})),this.plane.push(new v(o,this.material[this.material.length-1])),this.plane[this.plane.length-1].position.set(t,0,0),this.scene.add(this.plane[this.plane.length-1])}addColon(){const t=new f(.5,2,1,1),i=new L({color:16777215}),s=new v(t,i);s.position.set(1.5,0,0),this.scene.add(s),this.plane.push(s)}next(t,i,s,e,r=!1,n=!1){let h=.9,o=new g.timeline({}),d=!1;o.to(this.material[t].uniforms.progress,h,{value:this.current[t],ease:g.easeInOut,delay:0,yoyo:!0,onComplete:()=>{let u=this.textures[s+1>9?0:s+1];s===2&&e===3&&(u=this.textures[0]),n&&s+1>5&&e===2&&(u=this.textures[0],d=!0),this.current[t]===1?this.material[t].uniforms.texture1.value=u:this.material[t].uniforms.texture2.value=u,this.current[t]=this.current[t]===1?0:1}},0),(r||d)&&o.to(this.material[i].uniforms.progress,h,{value:this.current[i],ease:g.easeInOut,delay:0,yoyo:!0,onComplete:()=>{let u=this.textures[e+1>5?0:e+1];n&&s===2&&e===3&&(u=this.textures[0]),this.current[i]===1?this.material[i].uniforms.texture1.value=u:this.material[i].uniforms.texture2.value=u,this.current[i]=this.current[i]===1?0:1}},0)}animation(t=0){requestAnimationFrame(n=>this.animation(n)),t*=.001;const i=t-this.then;this.then=t;const s=this.getDigit("sec"),e=this.getDigit("min"),r=this.getDigit();this.state.sec[0]!==s[1]&&(this.state.sec[1]!==s[0]?(this.next(1,0,s[1],s[0],!0),this.state.sec[1]=s[0]):this.next(1,0,s[1],s[0]),this.state.sec[0]=s[1]),this.state.min[0]!==e[1]&&(this.state.min[1]!==e[0]?(this.next(3,2,e[1],e[0],!0),this.state.min[1]=e[0]):this.next(3,2,e[1],e[0]),this.state.min[0]=e[1]),this.state.hrs[0]!==r[1]&&(this.state.hrs[1]!==r[0]?(this.next(5,4,r[1],r[0],!0,!0),this.state.hrs[1]=r[0]):this.next(5,4,r[1],r[0],!1,!0),this.state.hrs[0]=r[1]),this.counter+=.01,this.customPass.uniforms.amount.value=this.counter,this.composer.render(i)}resize(){window.addEventListener("resize",()=>{this.width=this.target.offsetWidth,this.height=this.target.offsetHeight,this.camera.aspect=this.width/this.height,this.width<900?this.camera.position.z=13.4-this.width/100:this.camera.position.z=5,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)})}}const $={class:"preview",id:"preview"},q={class:"container"},J={class:"list"},Q=["onClick"],Z={class:"title"},tt={class:"previewImg"},et=["src"],it={__name:"index",setup(c){const t=z(),i=y({glitchClock:null,background:null,list:[]}),s=r=>new URL(r,import.meta.url).href,e=r=>{t.push({path:`/layout/${r.path}`})};return D(()=>{P(()=>{i.list=O,i.glitchClock=new K,i.background=new V})}),C(()=>{console.info("%c首页-销毁😁","color:#fff;background-color:red")}),(r,n)=>(m(),p("div",$,[n[1]||(n[1]=l("div",{class:"background",id:"background"},[l("canvas",{class:"canvas",id:"canvas"})],-1)),l("div",q,[n[0]||(n[0]=l("div",{class:"info"},[l("div",{class:"title"},"Just Threejs"),l("div",{class:"time",id:"time"})],-1)),l("div",J,[(m(!0),p(S,null,T(i.list,(h,o)=>(m(),p("div",{class:"item",key:o,onClick:d=>e(h)},[l("div",Z,Y(h.name),1),l("div",tt,[l("img",{src:s(h.meta.img),alt:""},null,8,et)])],8,Q))),128))])])]))}},ht=A(it,[["__scopeId","data-v-6685af3b"]]);export{ht as default};
