import{x as Q,v as R,ap as k,S as j,e as G,n as a,P as K,O as V,K as v,Q as T,X as U,V as O,Y as L,h as m,aq as q,$ as N,q as H,ar as Y,as as J,at as Z,au as W,g as X,M as u,a3 as $,a4 as ee,w as x,l,H as te,av as se,aw as ie,I as ne}from"./threejs-R2oN4ICD.js";import{P as ae,l as y,b as re,m as oe,i as f,c as A,d as p,F as le,n as ce,p as he,e as pe,q as de}from"./vendor-D10xMT_S.js";import{_ as ue}from"../lib/index-CADhc86s.js";const ge="data:application/json;base64,W3sibmVneCI6ICI2MzczNTU0NzkwMDEifSwgeyJuZWd5IjogIjYzNzM1NTUzODYwMSJ9LCB7Im5lZ3oiOiAiNjM3MzU1NjIwOTAxIn0sIHsicG9zeCI6ICI2MzczNTU2NjYzMDEifSwgeyJwb3N5IjogIjYzNzM1NTcxMzAwMSJ9LCB7InBvc3oiOiAiNjM3MzU1Nzk0ODAxIn1d",ve="/static/png/negx-93UPBYpg.png",me="/static/png/negy-BWIPjDZz.png",xe="/static/png/negz-BHTGpg25.png",ye="/static/png/posx-DALE1sWp.png",fe="/static/png/posy-BK3uDHxd.png",Ae="/static/png/posz-DxmjHBMv.png",Ce="/static/png/negx-BZXF1WCu.png",we="/static/png/negy-BxnsZrKn.png",Ie="/static/png/negz-CIKPOJjo.png",Pe="/static/png/posx-CkmFNUx9.png",be="/static/png/posy-WjQtEcX9.png",Be="/static/png/posz-oMpNLhAn.png",ze="/static/png/particle-C085uMzI.png",Ee="data:image/png;base64,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",Me="/static/hdr/%E5%AE%87%E5%AE%994K%20(5)-BvOKvqoE.hdr";var Se=`varying vec2 vUv;
void main(){
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
}`,Fe=`uniform sampler2D tDiffuse;
uniform sampler2D uBloomTexture;
uniform float uStrength;
varying vec2 vUv;
void main(){
    vec4 baseEffect = texture2D(tDiffuse, vUv);
    vec4 bloomEffect = texture2D(uBloomTexture, vUv) * uStrength;
    gl_FragColor = baseEffect + bloomEffect;
}`,De=`vec4 permute(vec4 x) {
    return mod(((x * 34.0) + 1.0) * x, 289.0);
}
vec4 taylorInvSqrt(vec4 r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

float snoise(vec3 v) {
    const vec2 C = vec2(1.0 / 6.0, 1.0 / 3.0);
    const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);

    
    vec3 i = floor(v + dot(v, C.yyy));
    vec3 x0 = v - i + dot(i, C.xxx);

    
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min(g.xyz, l.zxy);
    vec3 i2 = max(g.xyz, l.zxy);

    
    vec3 x1 = x0 - i1 + 1.0 * C.xxx;
    vec3 x2 = x0 - i2 + 2.0 * C.xxx;
    vec3 x3 = x0 - 1. + 3.0 * C.xxx;

    
    i = mod(i, 289.0);
    vec4 p = permute(permute(permute(
                    i.z + vec4(0.0, i1.z, i2.z, 1.0))
                    + i.y + vec4(0.0, i1.y, i2.y, 1.0))
                + i.x + vec4(0.0, i1.x, i2.x, 1.0));

    
    
    float n_ = 1.0 / 7.0; 
    vec3 ns = n_ * D.wyz - D.xzx;

    vec4 j = p - 49.0 * floor(p * ns.z * ns.z); 

    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_); 

    vec4 x = x_ * ns.x + ns.yyyy;
    vec4 y = y_ * ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);

    vec4 b0 = vec4(x.xy, y.xy);
    vec4 b1 = vec4(x.zw, y.zw);

    vec4 s0 = floor(b0) * 2.0 + 1.0;
    vec4 s1 = floor(b1) * 2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));

    vec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;
    vec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;

    vec3 p0 = vec3(a0.xy, h.x);
    vec3 p1 = vec3(a0.zw, h.y);
    vec3 p2 = vec3(a1.xy, h.z);
    vec3 p3 = vec3(a1.zw, h.w);

    
    vec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;

    
    vec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);
    m = m * m;
    return 42.0 * dot(m * m, vec4(dot(p0, x0), dot(p1, x1),
                dot(p2, x2), dot(p3, x3)));
}

uniform float uPixelDensity;
uniform float uBaseSize;
uniform float uFreq;
uniform float uAmp;
uniform float uEdge;
uniform float uProgress;

varying float vNoise;
varying float vAngle;

attribute vec3 aCurrentPos;
attribute float aDist;
attribute float aAngle;

void main() {
    vec3 pos = position;

    float noise = snoise(pos * uFreq) * uAmp;
    vNoise =noise;

    vAngle = aAngle;

    if (vNoise > uProgress-2.0 && vNoise < uProgress + uEdge+2.0){
        pos = aCurrentPos;
    }

    vec4 modelPosition = modelMatrix * vec4(pos, 1.0);
    vec4 viewPosition = viewMatrix * modelPosition;
    vec4 projectedPosition = projectionMatrix * viewPosition;
    gl_Position = projectedPosition;

    float size = uBaseSize * uPixelDensity;
    size = size  / (aDist + 1.0);
    gl_PointSize = size / -viewPosition.z;
}`,_e=`uniform vec3 uColor;
uniform float uEdge;
uniform float uProgress;
uniform sampler2D uTexture;

varying float vNoise;
varying float vAngle;

void main(){
    if (vNoise < uProgress) discard;
    if (vNoise > uProgress + uEdge) discard;

    vec2 coord = gl_PointCoord;
    coord = coord - 0.5;
    coord = coord * mat2(cos(vAngle), sin(vAngle), -sin(vAngle), cos(vAngle));
    coord = coord +  0.5;

    vec4 texture = texture2D(uTexture, coord);

    gl_FragColor = vec4(vec3(uColor.xyz * texture.xyz), 1.0);
}`,Qe=`vec4 permute(vec4 x) {
    return mod(((x * 34.0) + 1.0) * x, 289.0);
}
vec4 taylorInvSqrt(vec4 r) {
    return 1.79284291400159 - 0.85373472095314 * r;
}

float snoise(vec3 v) {
    const vec2 C = vec2(1.0 / 6.0, 1.0 / 3.0);
    const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);

    
    vec3 i = floor(v + dot(v, C.yyy));
    vec3 x0 = v - i + dot(i, C.xxx);

    
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min(g.xyz, l.zxy);
    vec3 i2 = max(g.xyz, l.zxy);

    
    vec3 x1 = x0 - i1 + 1.0 * C.xxx;
    vec3 x2 = x0 - i2 + 2.0 * C.xxx;
    vec3 x3 = x0 - 1. + 3.0 * C.xxx;

    
    i = mod(i, 289.0);
    vec4 p = permute(permute(permute(
                    i.z + vec4(0.0, i1.z, i2.z, 1.0))
                    + i.y + vec4(0.0, i1.y, i2.y, 1.0))
                + i.x + vec4(0.0, i1.x, i2.x, 1.0));

    
    
    float n_ = 1.0 / 7.0; 
    vec3 ns = n_ * D.wyz - D.xzx;

    vec4 j = p - 49.0 * floor(p * ns.z * ns.z); 

    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_); 

    vec4 x = x_ * ns.x + ns.yyyy;
    vec4 y = y_ * ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);

    vec4 b0 = vec4(x.xy, y.xy);
    vec4 b1 = vec4(x.zw, y.zw);

    vec4 s0 = floor(b0) * 2.0 + 1.0;
    vec4 s1 = floor(b1) * 2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));

    vec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;
    vec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;

    vec3 p0 = vec3(a0.xy, h.x);
    vec3 p1 = vec3(a0.zw, h.y);
    vec3 p2 = vec3(a1.xy, h.z);
    vec3 p3 = vec3(a1.zw, h.w);

    
    vec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;

    
    vec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);
    m = m * m;
    return 42.0 * dot(m * m, vec4(dot(p0, x0), dot(p1, x1),
                dot(p2, x2), dot(p3, x3)));
}`;function C(d){return new URL(Object.assign({"../assets/cubeMap1/config.json":ge,"../assets/cubeMap1/negx.png":ve,"../assets/cubeMap1/negy.png":me,"../assets/cubeMap1/negz.png":xe,"../assets/cubeMap1/posx.png":ye,"../assets/cubeMap1/posy.png":fe,"../assets/cubeMap1/posz.png":Ae,"../assets/cubeMap2/negx.png":Ce,"../assets/cubeMap2/negy.png":we,"../assets/cubeMap2/negz.png":Ie,"../assets/cubeMap2/posx.png":Pe,"../assets/cubeMap2/posy.png":be,"../assets/cubeMap2/posz.png":Be,"../assets/particle.png":ze,"../assets/star3.png":Ee,"../assets/宇宙4K (5).hdr":Me})[`../assets/${d}`],import.meta.url).href}class Re{constructor(e){this.parent=e.parent,this.target=e.target,this.callback=e.callback,this.devicePixelRatio=window.devicePixelRatio,this.width=this.target.offsetWidth*this.devicePixelRatio,this.height=this.target.offsetHeight*this.devicePixelRatio,this.clock=new Q,this.renderer=new R({powerPreference:"high-performance",antialias:!1,stencil:!1,depth:!1,preserveDrawingBuffer:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.toneMapping=k,this.renderer.outputColorSpace=j,this.target.appendChild(this.renderer.domElement),this.scene=new G,this.blackColor=new a(0),this.scene.background=this.blackColor,this.camera=new K(45,this.width/this.height,.1,100),this.camera.position.set(15,0,15),this.control=new V(this.camera,this.renderer.domElement),this.control.enableDamping=!0,this.composerInit(),this.geometryInit(),this.paramsInit(),this.particleInit(),this.paneInit(),this.assetsInit()}composerInit(){this.composer1=new v(this.renderer),this.composer2=new v(this.renderer),this.renderPass=new T(this.scene,this.camera),this.unrealBloomPass=new U(new O(this.height,this.width),.26,.4,.2),this.bloomPass=new L(new m({uniforms:{tDiffuse:{value:null},uBloomTexture:{value:this.composer1.renderTarget2.texture},uStrength:{value:12}},vertexShader:Se,fragmentShader:Fe})),this.smaaPass=new q(this.width,this.height),this.outPass=new N,this.composer1.addPass(this.renderPass),this.composer1.addPass(this.unrealBloomPass),this.composer1.renderToScreen=!1,this.composer2.addPass(this.renderPass),this.composer2.addPass(this.bloomPass),this.composer2.addPass(this.smaaPass),this.composer2.addPass(this.outPass)}paramsInit(){this.autoDissolve=!1,this.dissolving=!0,this.geoIdx=0,this.geoLength=this.geometries.length,this.meshColor="#"+new a("#636363").getHexString(),this.edgeColor="#"+new a("#4d9bff").getHexString(),this.particleColor="#"+new a("#4d9bff").getHexString(),this.particleData={particleSpeedFactor:.02,velocityFactor:{x:2.5,y:2},waveAmplitude:0},this.uniforms={uColor:{value:new a(5086207)},uFreq:{value:.45},uAmp:{value:16},uProgress:{value:-7},uEdge:{value:.8}}}beforeCompile(){this.meshPhysicalMaterial.onBeforeCompile=e=>{e.uniforms={...e.uniforms,...this.uniforms},e.vertexShader=e.vertexShader.replace("#include <common>",`#include <common>
                varying vec3 vPos;`),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>",`#include <begin_vertex>
                vPos = position;`),e.fragmentShader=e.fragmentShader.replace("#include <common>",`#include <common>
             
                 ${Qe}

                varying vec3 vPos;
                uniform vec3 uColor;
                uniform float uFreq;
                uniform float uAmp;
                uniform float uProgress;
                uniform float uEdge;
            `),e.fragmentShader=e.fragmentShader.replace("#include <dithering_fragment>",`#include <dithering_fragment>
                float noise = snoise(vPos* uFreq)*uAmp;
                if(noise < uProgress) discard;
                float edgeWidth = uProgress + uEdge;
                if(noise > uProgress && noise < edgeWidth){
                    gl_FragColor = vec4(uColor,noise);
                }
                gl_FragColor = vec4(gl_FragColor.xyz,1.0);
                
            `)}}geometryInit(){this.sphere=new H(4.5,140,140),this.teaPot=new Y(3,32),this.torus=new J(3,1.5,140,140),this.torusKnot=new Z(2.5,.8,140,140),this.geoNames=["TorusKnot","Tea Pot","Sphere","Torus"],this.geometries=[this.torusKnot,this.teaPot,this.sphere,this.torus],this.meshGeometry=this.geometries[0],this.meshPhysicalMaterial=new W({color:new a("#636363"),metalness:2,roughness:0,side:X}),this.beforeCompile(),this.mesh=new u(this.meshGeometry,this.meshPhysicalMaterial),this.scene.add(this.mesh)}particleInit(){this.particleMaterial=new m({transparent:!0,blending:$,uniforms:{uTexture:{value:this.particleTexture},uPixelDensity:{value:this.renderer.getPixelRatio()},uProgress:{value:this.uniforms.uProgress.value},uEdge:{value:.8},uAmp:{value:16},uFreq:{value:.25},uBaseSize:{value:80},uColor:{value:new a("#4d9bff")}},vertexShader:De,fragmentShader:_e}),this.particleMesh=new ee(this.meshGeometry,this.particleMaterial),this.scene.add(this.particleMesh),this.particleCount=this.meshGeometry.attributes.position.count,this.particleMaxOffsetArr=new Float32Array(this.particleCount),this.particleInitPosArr=new Float32Array(this.meshGeometry.getAttribute("position").array),this.particleCurrPosArr=new Float32Array(this.meshGeometry.getAttribute("position").array),this.particleVelocityArr=new Float32Array(this.particleCount*3),this.particleDistArr=new Float32Array(this.particleCount),this.particleRotationArr=new Float32Array(this.particleCount);for(let e=0;e<this.particleCount;e++){let t=e*3,s=e*3+1,i=e*3+2;this.particleMaxOffsetArr[e]=Math.random()*5.5+1.5,this.particleVelocityArr[t]=Math.random()*.5+.5,this.particleVelocityArr[s]=Math.random()*.5+.5,this.particleVelocityArr[i]=Math.random()*.1,this.particleDistArr[e]=.001,this.particleRotationArr[e]=Math.random()*Math.PI*2}this.setAttribute()}updateParticle(){for(let e=0;e<this.particleCount;e++){let t=e*3+0,s=e*3+1,i=e*3+2,n=this.particleVelocityArr[e*3+0],r=this.particleVelocityArr[e*3+1],o=this.particleVelocityArr[e*3+2];n*=this.particleData.velocityFactor.x,r*=this.particleData.velocityFactor.y;const c=this.particleCurrPosArr[e*3+0],h=this.particleCurrPosArr[e*3+1];let w=Math.sin(h*2)*(.8+this.particleData.waveAmplitude),I=Math.sin(c*2)*(.6+this.particleData.waveAmplitude),P=Math.sin(h*5)*(.2+this.particleData.waveAmplitude),b=Math.sin(c*1)*(.9+this.particleData.waveAmplitude),B=Math.sin(h*8)*(.8+this.particleData.waveAmplitude),z=Math.sin(c*5)*(.6+this.particleData.waveAmplitude),E=Math.sin(h*3)*(.8+this.particleData.waveAmplitude),M=Math.sin(c*7)*(.6+this.particleData.waveAmplitude),S=w+P+B+E,F=I+b+z+M;n+=S,r+=F,n*=Math.abs(this.particleData.particleSpeedFactor),r*=Math.abs(this.particleData.particleSpeedFactor),o*=Math.abs(this.particleData.particleSpeedFactor),this.particleCurrPosArr[t]+=n,this.particleCurrPosArr[s]+=r,this.particleCurrPosArr[i]+=o;const D=new x(this.particleInitPosArr[t],this.particleInitPosArr[s],this.particleInitPosArr[i]),_=new x(this.particleCurrPosArr[t],this.particleCurrPosArr[s],this.particleCurrPosArr[i]),g=D.distanceTo(_);this.particleDistArr[e]=g,this.particleRotationArr[e]+=.01,g>this.particleMaxOffsetArr[e]&&(this.particleCurrPosArr[t]=this.particleInitPosArr[t],this.particleCurrPosArr[s]=this.particleInitPosArr[s],this.particleCurrPosArr[i]=this.particleInitPosArr[i])}this.setAttribute()}setAttribute(){this.meshGeometry.setAttribute("aOffset",new l(this.particleMaxOffsetArr,1)),this.meshGeometry.setAttribute("aCurrentPos",new l(this.particleCurrPosArr,3)),this.meshGeometry.setAttribute("aVelocity",new l(this.particleVelocityArr,3)),this.meshGeometry.setAttribute("aDist",new l(this.particleDistArr,1)),this.meshGeometry.setAttribute("aAngle",new l(this.particleRotationArr,1))}floatMeshes(e){this.mesh.position.set(0,Math.sin(e*2)*.5,0),this.particleMesh.position.set(0,Math.sin(e*2)*.5,0)}async assetsInit(){this.manager=new te,this.cubeTexture=await new se(this.manager).loadAsync(C("宇宙4K (5).hdr")),this.cubeTexture.mapping=ie,this.scene.background=this.cubeTexture,this.scene.environment=this.cubeTexture,this.particleTexture=await new ne(this.manager).load(C("star3.png")),this.manager.onLoad=async()=>{console.info("%c资源加载完成!✅","color:#fff;background-color:red"),this.callback(),this.particleInit(),this.animation()}}resizeRenderer(){const e=this.target.offsetWidth*this.devicePixelRatio,t=this.target.offsetHeight*this.devicePixelRatio,s=this.width!==e||this.height!==t;return s&&(this.renderer.setSize(e,t),this.renderPass.setSize(e,t),this.outPass.setSize(e,t),this.unrealBloomPass.setSize(e,t),this.composer1.setSize(e,t),this.composer2.setSize(e,t),this.width=e,this.height=t),s}animateDissolve(){if(!this.autoDissolve)return;let e=this.uniforms.uProgress;this.dissolving?e.value+=.08:e.value-=.08,e.value>20&&this.dissolving&&(this.dissolving=!1,this.geoIdx++,this.handleChange(this.geometries[this.geoIdx%this.geoLength]),this.meshBlade.value=this.geometries[this.geoIdx%this.geoLength]),e.value<-20&&!this.dissolving&&(this.dissolving=!0),this.progressBinding.controller.value.setRawValue(e.value)}animation(){let e=this.clock.getElapsedTime();this.renderer.setAnimationLoop(()=>this.animation()),this.control.update(),this.updateParticle(),this.floatMeshes(e),this.animateDissolve(),this.resizeRenderer()&&(this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix()),this.scene.background=this.blackColor,this.composer1.render(),this.scene.background=this.cubeTexture,this.composer2.render()}handleChange(e){this.scene.remove(this.mesh),this.scene.remove(this.particleMesh),this.meshGeometry=e,this.mesh=new u(this.meshGeometry,this.meshPhysicalMaterial),this.particleInit(),this.scene.add(this.mesh)}paneInit(){this.pane=new ae({container:this.parent}),this.controller=this.pane.addFolder({title:"控制台",expanded:!0}),this.bloomFolder=this.controller.addFolder({title:"辉光",expanded:!0}),this.bloomFolder.addBinding(this.bloomPass.uniforms.uStrength,"value",{min:1,max:20,step:.01,label:"强度"}).on("change",e=>{this.bloomPass.uniforms.uStrength.value=e.value}),this.meshBlade=this.pane.addBlade({view:"list",label:"物体切换",options:[{text:"TorusKnot",value:this.torusKnot},{text:"Tea Pot",value:this.teaPot},{text:"Sphere",value:this.sphere},{text:"Torus",value:this.torus}],value:this.torusKnot}).on("change",e=>{this.handleChange(e.value)}),this.meshFolder=this.controller.addFolder({title:"物体",expanded:!0}),this.meshFolder.addBinding(this.mesh,"visible",{label:"显示物体"}).on("change",e=>{this.mesh.visible=e.value}),this.progressBinding=this.meshFolder.addBinding(this.uniforms.uProgress,"value",{min:-20,max:20,step:1e-4,label:"进度"}).on("change",e=>{this.uniforms.uProgress.value=e.value,this.particleMaterial.uniforms.uProgress.value=e.value}),this.meshFolder.addBinding(this,"autoDissolve",{label:"播放动画"}).on("change",e=>{this.autoDissolve=e.value}),this.meshFolder.addBinding(this.uniforms.uEdge,"value",{min:.1,max:8,step:.001,label:"边缘宽度"}).on("change",e=>{this.uniforms.uEdge.value=e.value}),this.meshFolder.addBinding(this.uniforms.uFreq,"value",{min:.001,max:2,step:.001,label:"频率"}).on("change",e=>{this.uniforms.uFreq.value=e.value}),this.meshFolder.addBinding(this.uniforms.uAmp,"value",{min:.1,max:50,step:.001,label:"振幅"}).on("change",e=>{this.uniforms.uAmp.value=e.value}),this.meshFolder.addBinding(this,"meshColor",{label:"物体颜色"}).on("change",e=>{this.meshPhysicalMaterial.color.set(e.value)}),this.meshFolder.addBinding(this,"edgeColor",{label:"边缘颜色"}).on("change",e=>{this.uniforms.uColor.value.set(e.value)}),this.particleFolder=this.controller.addFolder({title:"粒子",expanded:!0}),this.particleFolder.addBinding(this.particleMesh,"visible",{label:"显示粒子"}).on("change",e=>{this.particleMesh.visible=e.value}),this.particleFolder.addBinding(this.particleMaterial.uniforms.uBaseSize,"value",{min:.1,max:3e3,step:.01,label:"粒子大小"}).on("change",e=>{this.particleMaterial.uniforms.uBaseSize.value=e.value}),this.particleFolder.addBinding(this,"particleColor",{label:"粒子颜色"}).on("change",e=>{this.particleMaterial.uniforms.uColor.value.set(e.value)}),this.particleFolder.addBinding(this.particleData,"particleSpeedFactor",{min:.001,max:.1,step:.001,label:"粒子漂浮速度"}).on("change",e=>{this.particleData.particleSpeedFactor=e.value}),this.particleFolder.addBinding(this.particleData,"waveAmplitude",{min:0,max:5,step:.01,label:"粒子波幅"}).on("change",e=>{this.particleData.waveAmplitude=e.value}),this.particleFolder.addBinding(this.particleData,"velocityFactor",{expanded:!0,picker:"inline",label:"粒子方向"}).on("change",e=>{this.particleData.velocityFactor=e.value})}destroy(){this.scene.traverse(e=>{var t;e instanceof u&&((t=e.geometry)==null||t.dispose(),Object.values(e.material).forEach(s=>{s&&typeof s.dispose=="function"&&s.dispose()}))}),this.composer1.dispose(),this.composer2.dispose(),this.renderer.dispose()}}const ke={class:"dissipate"},je={class:"load"},Ge={__name:"index",setup(d){const e=y(!1);y(0);let t=null;const s=i=>{e.value=!0};return re(()=>{t=new Re({parent:document.querySelector(".dissipate"),target:document.querySelector(".canvas"),callback:s})}),oe(()=>{t.destroy(),t=null,console.info("%c消融特效-销毁😁","color:#fff;background-color:red")}),(i,n)=>(f(),A("div",ke,[p("div",{class:de(["loading",{loadOk:e.value}])},[p("div",je,[(f(),A(le,null,ce("LOADING...",(r,o)=>p("span",{key:o,style:he("--i:"+o)},pe(r),5)),64))])],2),n[0]||(n[0]=p("div",{class:"canvas"},null,-1))]))}},Ue=ue(Ge,[["__scopeId","data-v-f3f7da80"]]);export{Ue as default};
